var e="from"in Array;function t(t){if(e)return Array.from(t);for(var r=t.length,n=Array(r),o=0;o<r;o++)n[o]=t[o];return n}var r="create"in Object?Object.create(null):{};function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t,r){return(i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&o(i,r.prototype),i}).apply(null,arguments)}function a(e){var t="function"==typeof Map?new Map:void 0;return(a=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return i(e,arguments,n(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o(r,e)})(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,r,n,o){var i=t(e.children),a=Array.isArray(i),s=0;for(i=a?i:i[Symbol.iterator]();;){var l;if(a){if(s>=i.length)break;l=i[s++]}else{if((s=i.next()).done)break;l=s.value}var p=l;p.customElement=o;var f=p.dataset,h=function(i){var a=r[f[i]];if("o"===(i="class"===i?"className":i)[0]&&"n"===i[1]){var s;if(a=a.bind(p),p.hasAttribute("updates-reactively")){if(n)return d=i,"continue";s=function(){var n=t(arguments);a.apply(null,n),c(e,r,!0,o)}}else s=a;var l=i.substr(2);p._events||(p._events={}),p._events[l]||p.addEventListener(l,u),p._events[l]=s}else p[i]=a;d=i};for(var d in f)h(d);c(p,r,!1,o)}}function u(e){this._events[e.type](e)}var l=function(e,t,r){void 0===r&&(r=t),Object.defineProperty(e,r,{enumerable:!0,get:function(){var e=this.getAttribute(t);return null===e?"":e},set:function(e){this.setAttribute(t,e)}})},p=function(e,t,r){void 0===r&&(r=t),Object.defineProperty(e,r,{enumerable:!0,get:function(){return this.hasAttribute(t)},set:function(e){e?this.setAttribute(t,""):this.removeAttribute(t)}})},f=function(){if("undefined"!=typeof globalThis)return globalThis;Object.defineProperty(Object.prototype,"__this",{enumerable:!0,configurable:!0,get:function(){return this}});var e=__this;return delete Object.prototype.__this,e}();function h(e,t,r){var n=e.getAttribute("custom-element"),o=function(t){var o,i;function a(){var o;return(o=t.call(this)||this).s=o.attachShadow({mode:"open"}),o.s.appendChild(e.content.cloneNode(!0)),o.config=Object.assign({},n in r?r[n]:r),c(o.s,o.config,!1,s(o)),o.update=function(){return c(o.s,o.config,!0,s(o))},o}return i=t,(o=a).prototype=Object.create(i.prototype),o.prototype.constructor=o,o.__proto__=i,a}(a(HTMLElement)),i=t.modifyConstructor,u=t.modifyPrototype,h=t.observedAttributes,d=o.prototype;i&&i(o),u&&u(d),h&&function(e,t,r){var n={},o=[];Object.defineProperty(r,"attributeChangedCallback",{value:function(e,t,r){var n=this.__attrListeners[e];return n&&n.call(this,t,r)}});var i=e,a=Array.isArray(i),s=0;for(i=a?i:i[Symbol.iterator]();;){var c;if(a){if(s>=i.length)break;c=i[s++]}else{if((s=i.next()).done)break;c=s.value}var u=c,f=u.type,h=u.prop;n[h]=u.listener,o.push(h),"string"==typeof u||null==f||"string"===f?l(r,h):"bool"===f&&p(r,h)}t.observedAttributes=o,Object.defineProperty(r,"__attrListeners",{value:n})}(h,o,d),f.customElements.define(n,o)}var d=function(e,n,o){e=e||{};var i=o?Array.isArray(o)?o:[o]:t(document.querySelectorAll("template[is='custom']")),a=Array.isArray(i),s=0;for(i=a?i:i[Symbol.iterator]();;){var c;if(a){if(s>=i.length)break;c=i[s++]}else{if((s=i.next()).done)break;c=s.value}h(c,e[c.getAttribute("custom-element")]||r,n||r)}},v=(e,t)=>{var r=document.createElement("template");return r.setAttribute("is","custom"),r.setAttribute("custom-element",e),r.innerHTML=t||"",r},b="{{data}}",m=(e,t)=>{if(e===b&&(e=t),"object"!=typeof e)return document.createTextNode(e);var{el:r,attrs:n,children:o}=e;!Array.isArray(o)&&(o=[o]);var i=document.createElement(r);for(var a of Object.keys(n||{})){a===b&&(a=t);var s=n[a];s===b&&(s=t),"o"===a[0]&&"n"===a[1]?i.addEventListener(a.substr(2),s):i.setAttribute(a,s)}for(var c of o||[])i.appendChild(m(c,t));return i},y=e=>"string"==typeof e?JSON.parse(e):e,_=()=>d({"dom-repeat":{observedAttributes:[{prop:"domfor",listener(e,t){if(e!=t){var r;e&&(e=>{for(var t;t=e.lastChild;)e.removeChild(t)})(this.shadowRoot);var n=(t=y(t)).tree.el;r="Fragment"===n||null==n?document.createDocumentFragment():document.createElement(n);var o=t.tree.child;for(var i of y(t.loop)){var a=m(o,i);r.appendChild(a)}this.s.appendChild(r)}}}]}},{},v("dom-repeat")),g=(document.querySelector("base")||{}).href,A=(e,t)=>{var r=e.base||g;return t?new URL(r||"/",location.href).pathname:r};function w(e){var t=A(e),r=window.location.pathname;return t&&(r=new URL(r.replace(new URL(t,location.href).pathname,""),location.href).pathname),(r=r.replace(/^\//,""))||"/"}var P=()=>d({"dom-link":{modifyPrototype(e){Object.defineProperties(e,{__oc:{value(e){this.a.href&&(e.preventDefault(),window.history.pushState(0,0,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n="/";return(t=t.map((e,r)=>(r&&(e=e.replace(new RegExp("^"+n),"")),r!==t.length-1&&(e=e.replace(new RegExp(n+"$"),"")),e))).join(n)}(A(this,!0),new URL(this.a.href).pathname)),dispatchEvent(new Event("dom-router-on-link-click")))}},disconnectedCallback:{value(){this.a.removeEventListener(this._oc)}},connectedCallback:{value(){var e;for(this._oc=this.__oc.bind(this),this.a=this.s.getElementById("dom-link"),this.a.addEventListener("click",this._oc);e=(this._pendingProps||[]).pop();)this.a[e[0]]=e[1]}},attributeChangedCallback:{value(e,t,r){if(this.a)this.a[e]=r;else{var n=this._pendingProps||[];this._pendingProps=n,n.push([e,r])}}}})},modifyConstructor(e){e.observedAttributes=["target","download","ping","rel","relList","hreflang","type","referrerPolicy","text","coords","charset","name","rev","shape","href","origin","protocol","username","password","host","hostname","port","pathname","search","hash","style"]}},"dom-router":{modifyPrototype(e){Object.defineProperties(e,{paths:{get(){return this._paths},set(e){this._paths!==e&&(this._paths=e,this.setAttribute("path-data",Object.keys(e).join(", ")),this._onPop())}},__onPop:{value(){var e=w(this);if(e!==this.current){var t=this._paths[e];this.current=e,function(e,t,r){(e=>{for(var t;t=e.lastChild;)e.removeChild(t)})(e),"function"==typeof t&&(t=t(w(r))),e.appendChild(t)}(this.s,t,this)}}},connectedCallback:{value(){this._onPop=this.__onPop.bind(this),window.addEventListener("dom-router-on-link-click",this._onPop),window.addEventListener("popstate",this._onPop)}},disconnectedCallback:{value(){window.removeEventListener("dom-router-on-link-click",this._onPop),window.removeEventListener("popstate",this._onPop)}}})},observedAttributes:[{prop:"base"}]}},{},[v("dom-router"),v("dom-link","<a id='dom-link'><slot></slot></a>")]);export{_ as domRepeat,P as domRouter};
//# sourceMappingURL=index.modern.js.map
